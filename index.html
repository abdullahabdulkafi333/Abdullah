<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f6; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .sidebar { background: #2c3e50; color: white; min-height: 100vh; padding: 20px; }
        .card { border: none; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .btn-primary { background-color: #3498db; border: none; }
        .table-custom { background: white; border-radius: 10px; overflow: hidden; }
    </style>
</head>
<body>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-2 sidebar">
            <h3>المحاسب الذكي</h3>
            <hr>
            <button class="btn btn-outline-light w-100 mb-2" onclick="showSection('entry')">إدخال بيانات</button>
            <button class="btn btn-outline-light w-100 mb-2" onclick="showSection('reports')">التقارير والكشوفات</button>
        </div>

        <div class="col-md-10 p-4">
            <div class="row">
                <div class="col-md-6">
                    <div class="card p-3">
                        <h5><i class="bi bi-graph-up"></i> ميزان المراجعة (مباشر)</h5>
                        <div id="mizan-table" class="table-responsive">جاري التحميل...</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card p-3">
                        <h5><i class="bi bi-wallet2"></i> الأرصدة الحالية</h5>
                        <div id="balance-table" class="table-responsive">جاري التحميل...</div>
                    </div>
                </div>
            </div>

            <hr>

            <div id="entry-section" class="card p-4">
                <h4>إضافة قيد جديد</h4>
                <form id="accounting-form">
                    <div class="row">
                        <div class="col-md-3">
                            <input type="date" class="form-control" id="date" required>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="sheetSelect">
                                <option value="اليومية">اليومية</option>
                                <option value="المبيعات">المبيعات</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <input type="text" class="form-control" id="client" placeholder="اسم الحساب / العميل">
                        </div>
                        <div class="col-md-3">
                            <input type="number" class="form-control" id="amount" placeholder="المبلغ">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success mt-3 w-100">ترحيل البيانات</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // هنا يتم وضع رابط الـ Web App الذي حصلت عليه من Google Apps Script
    const WEB_APP_URL = "رابط_تطبيق_جوجل_هنا";

    // وظيفة لإرسال البيانات
    document.getElementById('accounting-form').onsubmit = function(e) {
        e.preventDefault();
        const data = [
            document.getElementById('date').value,
            document.getElementById('client').value,
            document.getElementById('amount').value
        ];
        const sheet = document.getElementById('sheetSelect').value;
        
        // استخدام Fetch API لإرسال البيانات إلى جوجل
        fetch(WEB_APP_URL, {
            method: 'POST',
            body: JSON.stringify({sheet: sheet, values: data})
        }).then(res => alert("تم الترحيل بنجاح"));
    };

    // وظيفة تحديث الميزان والأرصدة تلقائياً
    function refreshLiveTables() {
        // يتم استدعاء بيانات ميزان المراجعة عبر جوجل سكربت وعرضها هنا
    }
    
    setInterval(refreshLiveTables, 30000); // تحديث كل 30 ثانية
</script>
</body>
</html>